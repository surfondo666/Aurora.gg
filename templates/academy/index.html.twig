{% extends 'base.html.twig' %}

{% block title %}Academia | Aurora.gg
{% endblock %}

{% block body %}
	<div class="container mx-auto px-4 py-8">
		<div class="text-center mb-12">
			<h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-aurora-gold to-white uppercase tracking-widest mb-4">
				Academia Táctica
			</h1>
		
		</div>

		<div
			class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-16">

			{# Comandos #}
			{% set commands_imgs = [
            asset('img/img-academy/consola1.png'),
            asset('img/img-academy/consola2.png'),
            asset('img/img-academy/consola3.png')
        ] %}
			<a href="{{ path('app_academy_commands') }}" class="group relative overflow-hidden rounded-xl bg-aurora-card border border-aurora-border hover:border-aurora-gold transition-all duration-300 transform hover:-translate-y-2 js-slideshow-card" data-images='{{ commands_imgs|json_encode|raw }}'>

				<div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 z-20"></div>

				<div class="h-48 relative bg-[#1b2838] overflow-hidden">
					<img src="{{ commands_imgs[0] }}" alt="Comandos Background" class="js-slideshow-img absolute inset-0 w-full h-full object-cover transition-opacity duration-500 opacity-100">
				</div>

				<div class="p-6 relative z-30">
					<h3 class="text-2xl font-bold text-white mb-2 group-hover:text-aurora-gold transition-colors">Comandos</h3>
					<p class="text-gray-400 text-sm">Base de datos de comandos de consola, binds y cheats legales.</p>
				</div>
			</a>

			{# Lineups #}
			{% set lineups_imgs = [
            asset('img/img-academy/smoke1.png'),
            asset('img/img-academy/smoke2.png'),
            asset('img/img-academy/smoke3.png')
        ] %}
			<a href="{{ path('app_academy_videos') }}" class="group relative overflow-hidden rounded-xl bg-aurora-card border border-aurora-border hover:border-aurora-gold transition-all duration-300 transform hover:-translate-y-2 js-slideshow-card" data-images='{{ lineups_imgs|json_encode|raw }}'>

				<div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 z-20"></div>

				<div class="h-48 relative bg-[#1b2838] overflow-hidden">
					<img src="{{ lineups_imgs[0] }}" alt="Lineups Background" class="js-slideshow-img absolute inset-0 w-full h-full object-cover transition-opacity duration-500 opacity-100">
				</div>

				<div class="p-6 relative z-30">
					<h3 class="text-2xl font-bold text-white mb-2 group-hover:text-aurora-gold transition-colors">Lineups</h3>
					<p class="text-gray-400 text-sm">Aprende los mejores humos, flashes y molotovs para cada mapa.</p>
				</div>
			</a>

			{# Guías #}
			{% set guides_imgs = [
            asset('img/img-academy/guia1.png'),
            asset('img/img-academy/guia2.png'),
            asset('img/img-academy/guia3.png')
        ] %}
			<a href="{{ path('app_academy_guides') }}" class="group relative overflow-hidden rounded-xl bg-aurora-card border border-aurora-border hover:border-aurora-gold transition-all duration-300 transform hover:-translate-y-2 js-slideshow-card" data-images='{{ guides_imgs|json_encode|raw }}'>

				<div class="absolute inset-0 bg-gradient-to-b from-transparent to-black/90 z-20"></div>

				<div class="h-48 relative bg-[#1b2838] overflow-hidden">
					<img src="{{ guides_imgs[0] }}" alt="Guias Background" class="js-slideshow-img absolute inset-0 w-full h-full object-cover transition-opacity duration-500 opacity-100">
				</div>

				<div class="p-6 relative z-30">
					<h3 class="text-2xl font-bold text-white mb-2 group-hover:text-aurora-gold transition-colors">Guías</h3>
					<p class="text-gray-400 text-sm">Artículos detallados sobre economía, rotaciones y roles.</p>
				</div>
			</a>
		</div>

		<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
			<div>
				<h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
					<i class="fa-solid fa-upload text-aurora-gold"></i>
					Últimos Lineups
				</h2>
				<div class="space-y-4">
					{% for video in recent_videos %}
						<a href="{{ path('app_academy_videos', {'map': video.map}) }}" class="flex gap-4 p-3 rounded-lg bg-aurora-card border border-aurora-border hover:bg-[#1b2838] transition-colors">
							<img src="{{ asset('img/maps/' ~ video.map|lower ~ '_' ~ video.type|lower ~ '.jpg') }}" onerror="this.onerror=null;this.src='{{ asset('img/img-academy/consola3.png') }}';" alt="{{ video.map }} {{ video.type }}" class="w-24 h-16 object-cover rounded">
							<div>
								<h4 class="font-bold text-white text-sm line-clamp-1">{{ video.title }}</h4>
								<span class="text-xs uppercase px-2 py-0.5 rounded bg-gray-700 text-gray-300 mt-1 inline-block">{{ video.map }}</span>
								<span class="text-xs uppercase px-2 py-0.5 rounded bg-aurora-gold/20 text-aurora-gold mt-1 inline-block">{{ video.type }}</span>
							</div>
						</a>
					{% else %}
						<p class="text-gray-500 text-sm italic">No hay videos subidos aún.</p>
					{% endfor %}
				</div>
			</div>

			<div>
				<h2 class="text-xl font-bold text-white mb-4 flex items-center gap-2">
					<i class="fa-solid fa-pen-nib text-aurora-gold"></i>
					Últimas Guías
				</h2>
				<div class="space-y-4">
					{% for guide in recent_guides %}
						<a href="{{ path('app_academy_guide_show', {'id': guide.id}) }}" class="block p-4 rounded-lg bg-aurora-card border border-aurora-border hover:border-aurora-gold transition-all">
							<h4 class="font-bold text-white mb-1">{{ guide.title }}</h4>
							<div class="flex items-center gap-2 text-xs text-gray-400">
								<span>
									<i class="fa-regular fa-user"></i>
									{{ guide.author.userIdentifier }}</span>
								<span>&bull;</span>
								<span>{{ guide.createdAt|date('d M Y') }}</span>
							</div>
						</a>
					{% else %}
						<p class="text-gray-500 text-sm italic">No hay guías publicadas aún.</p>
					{% endfor %}
				</div>
			</div>
		</div>
	</div>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
const cards = document.querySelectorAll('.js-slideshow-card');

cards.forEach(card => {
const images = JSON.parse(card.dataset.images);
const imgElement = card.querySelector('.js-slideshow-img');

// Si no hay imágenes o solo hay 1, poner la primera y salir
if (! images || images.length === 0) 
return;



imgElement.src = images[0];
if (images.length === 1) 
return;



let currentIndex = 0;

setInterval(() => { // 1. Fade out (opacidad 0)
imgElement.style.opacity = '0';

setTimeout(() => { // 2. Cambiar imagen
currentIndex = (currentIndex + 1) % images.length;
imgElement.src = images[currentIndex];

// 3. Fade in (esperar un poco para que cargue o fluya la transición)
requestAnimationFrame(() => {
imgElement.style.opacity = '1';
});
}, 500); // Este tiempo debe coincidir con la clase 'duration-1000' de Tailwind

}, 4000); // Cambia cada 4 segundos
});
});
	</script>
{% endblock %}
